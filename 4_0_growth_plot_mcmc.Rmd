# Forest growth model MCMC results

```{r}
prefixes <- c('D:/azvoleff/Data', # CI-TEAM
              'H:/Data', # Buffalo drive
              'O:/Data', # Blue drive
              '/localdisk/home/azvoleff/Data') # vertica1
prefix <- prefixes[match(TRUE, unlist(lapply(prefixes, function(x) file_test('-d', x))))]

library(knitr)
library(runjags)
library(coda)

#par(mar=c(1,1,1,1))

start_val <- 10000
thin_val <- 4
```

## Simple model (no random effects)

Make a function for plotting simple model:

```{r}
plot_simple_model <- function(title) {
    fixefs <- as.mcmc.list(jags_fit, c("B["))
    fixefs <- window(fixefs, start=start_val, thin=thin_val)
    mcmcplot(fixefs, title=title)
    #caterplot(fixefs)

    sigmas <- as.mcmc.list(jags_fit, c("sigma_"))
    sigmas <- window(sigmas, start=start_val, thin=thin_val)
    mcmcplot(sigmas, title=title)

#    ranefs_site <- as.mcmc.list(jags_fit, c("^int_k"))
#    ranefs_site <- window(ranefs_site, start=start_val, thin=thin_val)
#    mcmcplot(ranefs_site)
}
```

### Minimum temperature

```{r}
load(file.path(prefix, "TEAM", "Tree_Growth", "MCMC_Chains", "simple", 
               "simple_tmn.RData"))
plot_simple_model('simple min temp')
```

### Mean temperature

```{r}
load(file.path(prefix, "TEAM", "Tree_Growth", "MCMC_Chains", "simple", 
               "simple_tmp.RData"))
plot_simple_model('simple mean temp')
```

### Maximum temperature

```{r}
load(file.path(prefix, "TEAM", "Tree_Growth", "MCMC_Chains", "simple", 
               "simple_tmx.RData"))
plot_simple_model('simple max temp')
```

## Smaller model (UDZ, BIF, VB only)

Make a function for plotting restricted site models:

```{r}
plot_small_model <- function() {
    fixefs <- as.mcmc.list(jags_fit, c("B[1]", "B[2]"))
    fixefs <- window(fixefs, start=start_val, thin=thin_val)
    plot(fixefs)
    ranefs_site <- as.mcmc.list(jags_fit, c("^int_k"))
    ranefs_site <- window(ranefs_site, start=start_val, thin=thin_val)
    plot(ranefs_site)
}
```

### Minimum temperature

```{r}
load(file.path(prefix, "TEAM", "Tree_Growth", "MCMC_Chains", "highelev", 
               "highelev_tmn.RData"))
plot_small_model()
```

### Mean temperature

```{r}
load(file.path(prefix, "TEAM", "Tree_Growth", "MCMC_Chains", "highelev", 
               "highelev_tmp.RData"))
plot_small_model()
```

### Maximum temperature

```{r}
load(file.path(prefix, "TEAM", "Tree_Growth", "MCMC_Chains", "highelev", 
               "highelev_tmx.RData"))
plot_small_model()
```

## Full model (interactions, uncorrelated random effects)

```{r}
plot_full_interact_model <- function() {
    fixefs <- as.mcmc.list(jags_fit, c("B[1]", "B[2]"))
    fixefs <- window(fixefs, start=start_val, thin=thin_val)
    plot(fixefs)
    ranefs_site <- as.mcmc.list(jags_fit, c("^int_k"))
    ranefs_site <- window(ranefs_site, start=start_val, thin=thin_val)
    plot(ranefs_site)
}
```

### Minimum temperature

```{r}
load(file.path(prefix, "TEAM", "Tree_Growth", "MCMC_Chains", "interact", 
               "interact_tmx.RData"))
plot_full_interact_model()
```

### Mean temperature

```{r}
load(file.path(prefix, "TEAM", "Tree_Growth", "MCMC_Chains", "interact", 
               "interact_tmx.RData"))
plot_full_interact_model()
```

### Maximum temperature

```{r}
load(file.path(prefix, "TEAM", "Tree_Growth", "MCMC_Chains", "interact", 
               "interact_tmx.RData"))
plot_full_interact_model()
```

## Full model (correlated random effects)

```{r}
plot_full_correlated_model <- function() {
    fixefs <- as.mcmc.list(jags_fit, c("B[1]", "B[2]"))
    fixefs <- window(fixefs, start=start_val, thin=thin_val)
    plot(fixefs)
    ranefs_site <- as.mcmc.list(jags_fit, c("^int_k"))
    ranefs_site <- window(ranefs_site, start=start_val, thin=thin_val)
    plot(ranefs_site)
}
```

### Minimum temperature

### Mean temperature

### Maximum temperature

